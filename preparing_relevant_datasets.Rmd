---
title: "Preparing Relevant Datasets"
output: html_notebook
---

```{r}
library(tidyverse)
library(janitor)
library(modelr)
library(dplyr)
library(ggplot2)
library(countrycode)
library(readxl)
library(xlsx)
```

```{r}
cross_country_infrastructure_investment <-
read_xls("data/Cross country infrastructure investment.xls") %>% 
  clean_names() %>% 
  select(-indicator) %>% 
  mutate(alpha_3_code = location,
         subject = str_to_lower(subject))

unique(cross_country_infrastructure_investment$subject)

country_codes <-
read_csv("own_data/countries_codes_and_coordinates.csv") %>% 
  clean_names() %>% 
  select(country, alpha_3_code)

country_codes

cross_country_infrastructure_investment <-
inner_join(country_codes, cross_country_infrastructure_investment, by = "alpha_3_code") %>% 
  select(-c(alpha_3_code, location, frequency, flag_codes))

cross_country_infrastructure_investment_eur <-
  cross_country_infrastructure_investment %>% 
  filter(measure == "EUR")

cross_country_infrastructure_investment_eur

cross_country_infrastructure_investment_gdp <-
  cross_country_infrastructure_investment %>% 
  filter(measure != "EUR")

cross_country_infrastructure_investment_gdp
```


```{r}
international_labour_productivity <-
read_xls("data/International Labour Productivity - Europe.xls", 3) 
  


international_labour_productivity %>% 
  select(-...1)
```

```{r}
international_labour_productivity_growth <-
read_xls("data/International Labour Productivity - Europe.xls", 4) %>% 
  tail(-2) %>% 
  row_to_names(1) %>% 
  select(-1) %>% 
  t() %>% 
  as.data.frame() %>% 
  row_to_names(1) %>% 
  add_rownames(var = "rowname") %>% 
  rename(country = rowname) %>% 
  clean_names() %>% 
  select(country:arts_entertainment_and_recreation_other_service_activities) %>%   
  mutate(agriculture_forestry_and_fishing = as.character(agriculture_forestry_and_fishing),
         industry_except_construction = as.character(industry_except_construction),
         construction = as.character(construction),
         wholesale_and_retail_trade_transport_accommodation_and_food_service_activities = as.character(wholesale_and_retail_trade_transport_accommodation_and_food_service_activities),
         information_and_communication = as.character(information_and_communication),
         financial_and_insurance_activities = as.character(financial_and_insurance_activities),
         professional_scientific_and_technical_activities_administrative_and_support_service_activities = as.character(professional_scientific_and_technical_activities_administrative_and_support_service_activities),
         public_administration_defence_education_human_health_and_social_work_activities = as.character(public_administration_defence_education_human_health_and_social_work_activities),
         arts_entertainment_and_recreation_other_service_activities = as.character(arts_entertainment_and_recreation_other_service_activities)
         ) %>% 
    mutate(agriculture_forestry_and_fishing = as.numeric(agriculture_forestry_and_fishing),
         industry_except_construction = as.numeric(industry_except_construction),
         construction = as.numeric(construction),
         wholesale_and_retail_trade_transport_accommodation_and_food_service_activities = as.numeric(wholesale_and_retail_trade_transport_accommodation_and_food_service_activities),
         information_and_communication = as.numeric(information_and_communication),
         financial_and_insurance_activities = as.numeric(financial_and_insurance_activities),
         professional_scientific_and_technical_activities_administrative_and_support_service_activities = as.numeric(professional_scientific_and_technical_activities_administrative_and_support_service_activities),
         public_administration_defence_education_human_health_and_social_work_activities = as.numeric(public_administration_defence_education_human_health_and_social_work_activities),
         arts_entertainment_and_recreation_other_service_activities = as.numeric(arts_entertainment_and_recreation_other_service_activities)
         ) %>% 
  mutate(avg_across_industries = rowSums(.[2:10]) / 9)


international_labour_productivity_growth

international_labour_productivity_growth %>% 
  ggplot() +
  aes(x = reorder(country, -avg_across_industries) , y = avg_across_industries) +
  geom_col() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust =1))



```




```{r}
international_labour_productivity_gdpphr <-
read_xls("data/International Labour Productivity - Europe.xls", 3) %>% 
  tail(-2) %>% 
  row_to_names(1) %>% 
  select(-1) %>% 
  t() %>% 
  as.data.frame() %>% 
  row_to_names(1) %>% 
  add_rownames(var = "rowname") %>% 
  rename(country = rowname) %>% 
  clean_names() %>% 
  select(country:arts_entertainment_and_recreation_other_service_activities) %>%   
  mutate(agriculture_forestry_and_fishing = as.character(agriculture_forestry_and_fishing),
         industry_except_construction = as.character(industry_except_construction),
         construction = as.character(construction),
         wholesale_and_retail_trade_transport_accommodation_and_food_service_activities = as.character(wholesale_and_retail_trade_transport_accommodation_and_food_service_activities),
         information_and_communication = as.character(information_and_communication),
         financial_and_insurance_activities = as.character(financial_and_insurance_activities),
         professional_scientific_and_technical_activities_administrative_and_support_service_activities = as.character(professional_scientific_and_technical_activities_administrative_and_support_service_activities),
         public_administration_defence_education_human_health_and_social_work_activities = as.character(public_administration_defence_education_human_health_and_social_work_activities),
         arts_entertainment_and_recreation_other_service_activities = as.character(arts_entertainment_and_recreation_other_service_activities)
         ) %>% 
    mutate(agriculture_forestry_and_fishing = as.numeric(agriculture_forestry_and_fishing),
         industry_except_construction = as.numeric(industry_except_construction),
         construction = as.numeric(construction),
         wholesale_and_retail_trade_transport_accommodation_and_food_service_activities = as.numeric(wholesale_and_retail_trade_transport_accommodation_and_food_service_activities),
         information_and_communication = as.numeric(information_and_communication),
         financial_and_insurance_activities = as.numeric(financial_and_insurance_activities),
         professional_scientific_and_technical_activities_administrative_and_support_service_activities = as.numeric(professional_scientific_and_technical_activities_administrative_and_support_service_activities),
         public_administration_defence_education_human_health_and_social_work_activities = as.numeric(public_administration_defence_education_human_health_and_social_work_activities),
         arts_entertainment_and_recreation_other_service_activities = as.numeric(arts_entertainment_and_recreation_other_service_activities)
         ) %>% 
  mutate(avg_across_industries = rowSums(.[2:10]) / 9)



international_labour_productivity_gdpphr %>% 
  ggplot() +
  aes(x = reorder(country, -avg_across_industries) , y = avg_across_industries) +
  geom_col() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust =1)) +
  labs(x = "EU country", y = "GDP per hour worked")



international_labour_productivity_gdpphr %>% 
  filter(country == "Norway") 
```

















```{r}
#so this dataset has many years, as opposed to the one above. but it doesn't have it by sector. so could use one above to supplement, if only i could figure out how to plot the different idustries.

labour_productivity_OECD <-
read_csv("data/Labour Productivity - OECD Countries.csv") %>% 
  clean_names() %>% 
  select(-indicator) %>% 
  filter(measure == "USD") %>% 
  rename(value_usd = value) %>% 
  select(-measure, -frequency, -flag_codes, -subject)
  
labour_productivity_OECD

unique(labour_productivity_OECD$subject)
```



```{r}
multifactor_productivity_annual_growth <-
read_xls("data/Multifactor Productivity - OECD Countries.xls") %>% 
  clean_names() %>% 
  filter(measure == "AGRWTH") %>% 
  select(-measure) %>% 
  rename(value_usd = value) %>% 
  select(-indicator, -subject, -flag_codes) %>%
  select(-frequency)

multifactor_productivity_annual_growth

multifactor_productivity_annual_growth %>% 
  ggplot() +
  aes(x = time, y = value_usd, dodge = location) +
  geom_line()


unique(multifactor_productivity_annual_growth$location)

inner_join(multifactor_productivity_annual_growth, country_codes, by = c("location" = "alpha_3_code")) %>% 
  select(-location) %>% 
  write_csv("clean_data/multifactor_productivity_annual_growth")

joined_with_country <-
inner_join(multifactor_productivity_annual_growth, country_codes, by = c("location" = "alpha_3_code")) %>% 
  dplyr::select(-location)

joined_with_country


countries <-
unique(joined_with_country$country)

countries <- c("Australia" ,  "Austria"   ,   "Belgium"        ,    "Canada"    ,        
 "Denmark"         ,   "Finland"      ,      "France"        ,     "Germany"      ,     
 "Ireland"    ,        "Italy"            ,  "Japan"        ,      "Korea, Republic of",
 "South Korea"   ,     "Netherlands"   ,     "New Zealand"   ,     "Portugal"          ,
 "Spain"          ,    "Sweden"        ,     "Switzerland"    ,    "United Kingdom"    ,
 "United States"   )


countries


multifactor_productivity_annual_growth
```

```{r}
#rate_of_decline <-
multifactor_productivity_annual_growth

  multifactor_productivity_annual_growth %>% 
  group_by(country) %>% 
  summarise(average_decline = mean(value_usd))
```



```{r}
library(leaps)
```


```{r}
productivity_model <- lm(value_usd ~ country + time, data = multifactor_productivity_annual_growth)

summary(productivity_model)
```


```{r}
cross_country_infrastructure_investment <-
read_xls("data/Cross country infrastructure investment.xls") %>% 
  clean_names() %>% 
  select(-indicator) %>% 
  mutate(alpha_3_code = location,
         subject = str_to_lower(subject))

unique(cross_country_infrastructure_investment$subject)

country_codes <-
read_csv("own_data/countries_codes_and_coordinates.csv") %>% 
  clean_names() %>% 
  select(country, alpha_3_code)

country_codes

cross_country_infrastructure_investment <-
inner_join(country_codes, cross_country_infrastructure_investment, by = "alpha_3_code") %>% 
  select(-c(alpha_3_code, location, frequency, flag_codes))

cross_country_infrastructure_investment_eur <-
  cross_country_infrastructure_investment %>% 
  filter(measure == "EUR")

cross_country_infrastructure_investment_eur

cross_country_infrastructure_investment_gdp <-
  cross_country_infrastructure_investment %>% 
  filter(measure != "EUR")

unique(cross_country_infrastructure_investment_gdp$subject)

multifactor_productivity_annual_growth
```

```{r}
investment_and_gdp_annual_growth <-
inner_join(cross_country_infrastructure_investment_gdp, multifactor_productivity_annual_growth, by = c("time", "country")) %>% 
  rename(multifactor_gdp_growth = value_usd,
         percentage_of_gdp = value,
         year = time) %>%   
  dplyr::select(-subject)

#ma <- function(x, n = 5){filter(x, rep(1 / n, n), sides = 2)}


#  mutate(average_investment_as_gdp_percentage_over_5_years = ) %>% 

library(tsibble)

investment_and_gdp_annual_growth <-
investment_and_gdp_annual_growth %>%
  as_tsibble(index = year,
             key = country) %>% # this is your unique identifyer
  mutate(rolling_5_year_avg = as.numeric(slider::slide(
                        .x = percentage_of_gdp, # the thing you pivoted out
                        .f = ~ mean(., na.rm = TRUE),
                        .before = 5 # how many values you want to average
                        )
  ) 
  ) %>%
  as_tibble()


investment_and_gdp_annual_growth %>% 
  mutate(difference_between_5_yr_investment_and_gdp = multifactor_gdp_growth - rolling_5_year_avg) %>% 
  filter(country == "Belgium") %>% 
  ggplot() +
  aes(x = year, y = difference_between_5_yr_investment_and_gdp) +
  geom_line()


investment_and_gdp_annual_growth

investment_and_gdp_annual_growth %>%
  as_tsibble(index = year,
             key = country) %>% # this is your unique identifyer
  mutate( = as.numeric(slider::slide(
                        .x = percentage_of_gdp, # the thing you pivoted out
                        .f = ~ mea n(., na.rm = TRUE),
                        .before = 1 # how many values you want to average
                        )
  ) 
  ) %>%
  as_tibble()
#in the first 
investment_and_gdp_annual_growth <-
investment_and_gdp_annual_growth %>% 
  mutate(increase_from_previous_year = percentage_of_gdp / lag(percentage_of_gdp)) %>% 
  rename(investment_as_percentage_of_gdp = percentage_of_gdp)
  
investment_and_gdp_annual_growth <-
  investment_and_gdp_annual_growth[, c(1, 3, 4, 6, 5, 7, 2)] %>% 
  rename(investment_rolling_5_year_avg = rolling_5_year_avg)

investment_and_gdp_annual_growth <-
  investment_and_gdp_annual_growth %>% 
          rename(investment_increase_from_previous_year = increase_from_previous_year)

investment_and_gdp_annual_growth

investment_and_gdp_annual_growth_ml <- lm(multifactor_gdp_growth ~ investment_as_percentage_of_gdp, data = investment_and_gdp_annual_growth)

summary(investment_and_gdp_annual_growth_ml)
```


++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

















```{r}
#so this dataset has many years, as opposed to the one above. but it doesn't have it by sector. so could use one above to supplement, if only i could figure out how to plot the different idustries.

labour_productivity_OECD <-
read_csv("data/Labour Productivity - OECD Countries.csv") %>% 
  clean_names() %>% 
  select(-indicator) %>% 
  filter(measure == "USD") %>% 
  rename(value_usd = value) %>% 
  select(-measure, -frequency, -flag_codes, -subject)
  
labour_productivity_OECD

unique(labour_productivity_OECD$subject)
```



```{r}
labour_productivity_OECD <-

inner_join(labour_productivity_OECD, country_codes, by = c("location" = "alpha_3_code")) %>% 
  dplyr::select(-location) 


```


```{r}
investment_and_per_hour_gdp <-
inner_join(cross_country_infrastructure_investment_gdp, labour_productivity_OECD, by = c("time", "country")) %>% 
  rename(multifactor_gdp_growth = value_usd,
         percentage_of_gdp = value,
         year = time) %>%   
  dplyr::select(-c("subject", "measure")) %>% 
          rename(investment_as_percentage_of_gdp = percentage_of_gdp,
                 multifactor_gdp = multifactor_gdp_growth)




investment_and_per_hour_gdp_ml <- lm(multifactor_gdp ~ investment_as_percentage_of_gdp, data = investment_and_per_hour_gdp)

rolling_investment_and_gdp_annual_growth_ml <- lm(multifactor_gdp_growth ~ investment_rolling_5_year_avg, data = investment_and_gdp_annual_growth)


investment_and_gdp_annual_growth

summary(investment_and_gdp_annual_growth_ml)

summary(investment_and_per_hour_gdp_ml)

summary(rolling_investment_and_gdp_annual_growth_ml)

```

 
```{r}
investment_and_per_hour_gdp %>% 
  group_by(year) %>% 
  summarise(average_oecd_growth = mean(multifactor_gdp)) %>% 
  ggplot() +
  aes(x = year, y = average_oecd_growth) +
  geom_col(fill = "#800020") +
  theme(axis.text.x = element_text(angle = 45, vjust = 0.5)) +
  scale_x_continuous(breaks = 1995:2016) +
  labs(x = "Year", y = "Multifactor GDP") +
  coord_cartesian(ylim = c(30, 50))

```


```{r}
investment_and_per_hour_gdp %>% 
  group_by(year) %>% 
  summarise(average_oecd_growth = mean(multifactor_gdp)) %>% 
  ggplot() +
  aes(x = year, y = average_oecd_growth) +
  geom_line(colour = "#800020") +
  theme(axis.text.x = element_text(angle = 45, vjust = 0.5)) +
  scale_x_continuous(breaks = 1995:2016) +
  labs(x = "Year", y = "Multifactor GDP") +
  coord_cartesian(ylim = c(30, 50))

```


```{r}
average_oecd_gdp_growth <-
investment_and_gdp_annual_growth %>% 
  group_by(year) %>% 
  summarise(average_oecd_gdp_growth = mean(multifactor_gdp_growth))

average_oecd_investment <-
investment_and_per_hour_gdp %>% 
  group_by(year) %>% 
  summarise(average_oecd_investment = mean(investment_as_percentage_of_gdp))


inner_join(average_oecd_gdp_growth, average_oecd_investment, by = "year") %>% 
  ggplot() +
  geom_line(aes(x = year, y = average_oecd_gdp_growth, color = "red", name = "gdp")) +
  geom_line(aes(x = year, y = average_oecd_investment, color = "green")) +
  theme(axis.text.x = element_text(angle = 45, vjust = 0.5)) +
  scale_x_continuous(breaks = 1995:2016) +
  labs(x = "Year", y = "%") +
  geom_label()


```




```{r}
real_minimum_wage <-
read_xlsx("data/Real minimum wages OECD.xlsx") %>% 
  clean_names() %>% 
  tail(-4) %>% 
  row_to_names(1) %>% 
  tail(-1) %>% 
  dplyr::select(-2) %>% 
  pivot_longer(cols = "2000":"2017",
               names_to = "year"
               ) %>% 
  rename(annual_pay_in_usd = value) %>%
  filter(annual_pay_in_usd != "..")

library(stringr)

#%>% 
  select(-indicator) %>% 
  mutate(alpha_3_code = location,
         subject = str_to_lower(subject))

real_minimum_wage <-
real_minimum_wage %>% 
  mutate(annual_pay_in_usd = str_extract(annual_pay_in_usd, "^[0-9]+")) %>% 
  mutate(annual_pay_in_usd = as.numeric(annual_pay_in_usd))

real_minimum_wage <-
real_minimum_wage %>% 
  rename(country = Time)

real_minimum_wage <-
real_minimum_wage %>% 
  mutate(year = as.double(year))

  
  
```





```{r}
read_xls("data/Regional Labour Market - Scotland.xls", 2)
```



```{r}
adult_education_levels <-
read_xlsx("additional_data/OECD Adult Education Levels.xlsx")

adult_education_levels

adult_education_levels_tertiary <-
inner_join(country_codes, adult_education_levels, by = c("alpha_3_code" = "LOCATION")) %>% 
  clean_names() %>% 
  dplyr::select(-alpha_3_code, -indicator, -subject, -frequency, -flag_codes, -measure) %>% 
  rename(percentage_of_25_64_year_olds = value,
         year = time) %>% 
  arrange(country, year) %>% 
  tail(-1)


adult_education_levels_tertiary



adult_education_levels_tertiary %>% 
  group_by(country) %>% 
  filter(year > 1995,
         country != "Russia",
         country != "Russian Federation",
         country != "Israel") %>% 
  summarise(average_education_over_years = mean(percentage_of_25_64_year_olds)) %>% 
  ggplot() +
  aes(x = reorder(country, -average_education_over_years), y = average_education_over_years) +
  geom_col(fill = "#800020") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
  labs(x = "Country", y = "Average Education Over Years") 
  


investment_gdp_and_adult_education_levels_tertiary <-
inner_join(investment_and_per_hour_gdp, adult_education_levels_tertiary, by = c("year", "country"))

investment_gdp_and_adult_education_levels_tertiary_minimum_wage <-
  inner_join(investment_gdp_and_adult_education_levels_tertiary, real_minimum_wage, by = c("year", "country"))


unique(investment_gdp_and_adult_education_levels_tertiary_minimum_wage$country)


investment_gdp_and_adult_education_levels_tertiary_minimum_wage

education_gdp_model <- lm(multifactor_gdp ~ percentage_of_25_64_year_olds, data = investment_gdp_and_adult_education_levels_tertiary_minimum_wage)

wage_gdp_model <- lm(multifactor_gdp ~ annual_pay_in_usd, data = investment_gdp_and_adult_education_levels_tertiary_minimum_wage)



summary(education_gdp_model)

summary(wage_gdp_model)

```




```{r}
technology_by_country <-
  read_xls("additional_data/TechnologyByCountry.xls") %>% 
  tail(-2) %>% 
  clean_names() %>% 
  dplyr::select(-world_development_indicators, -x4) %>% 
  row_to_names(1) %>% 
  pivot_longer(cols = "1960":"2017",
               names_to = "year") %>% 
  clean_names() %>% 
  pivot_wider(names_from = indicator_name,
              values_from = value) %>% 
  mutate(year = as.numeric(year)) %>% 
  filter(year > 1990) %>% 
  rename(country = country_name)

technology_by_country

investment_gdp_and_adult_education_levels_tertiary_minimum_wage_tech <-
inner_join(technology_by_country, investment_gdp_and_adult_education_levels_tertiary_minimum_wage, by = c("year", "country")) %>% 
  clean_names()
  
investment_gdp_and_adult_education_levels_tertiary_minimum_wage_tech

all_factors_model <- lm(multifactor_gdp ~ high_technology_exports_percent_of_manufactured_exports + percentage_of_25_64_year_olds + annual_pay_in_usd + investment_as_percentage_of_gdp, data = investment_gdp_and_adult_education_levels_tertiary_minimum_wage_tech)

summary(all_factors_model)

tech_investment_model <- lm(multifactor_gdp ~ high_technology_exports_percent_of_manufactured_exports, data = investment_gdp_and_adult_education_levels_tertiary_minimum_wage_tech)

summary(tech_investment_model)


investment_gdp_and_adult_education_levels_tertiary_minimum_wage_tech <-
investment_gdp_and_adult_education_levels_tertiary_minimum_wage_tech %>% 
  mutate(high_technology_exports_percent_of_manufactured_exports = as.numeric(high_technology_exports_percent_of_manufactured_exports))

investment_gdp_and_adult_education_levels_tertiary_minimum_wage_tech_shorter <-
  investment_gdp_and_adult_education_levels_tertiary_minimum_wage_tech %>% 
  dplyr::select(high_technology_exports_percent_of_manufactured_exports, investment_as_percentage_of_gdp, multifactor_gdp, annual_pay_in_usd)

library(GGally)

ggpairs(investment_gdp_and_adult_education_levels_tertiary_minimum_wage_tech_shorter)

investment_gdp_and_adult_education_levels_tertiary_minimum_wage_tech

summary(all_factors_model)

investment_gdp_and_adult_education_levels_tertiary_minimum_wage_tech

ggpairs(investment_gdp_and_adult_education_levels_tertiary_minimum_wage_tech %>% 
          filter(country == "United Kingdom") %>% 
          dplyr::select(annual_pay_in_usd, percentage_of_25_64_year_olds))

```





```{r}
average_oecd_gdp_growth %>% 
  filter(year < 2000) %>% 
  summarise(average_oecd_gdp_growth_through_90s = mean(average_oecd_gdp_growth))

average_oecd_gdp_growth %>% 
  filter(year > 2000,
         year < 2010) %>% 
  summarise(average_oecd_gdp_growth_through_00s = mean(average_oecd_gdp_growth))

average_oecd_gdp_growth %>% 
  filter(year > 2010) %>% 
  summarise(average_oecd_gdp_growth_through_10s = mean(average_oecd_gdp_growth))


  multifactor_productivity_annual_growth %>% 
   group_by(country) %>% 
     filter(time < 2000,
            time > 1990) %>% 
   summarise(average_growth_per_country_in_nineties = mean(value_usd)) %>% 
   arrange(desc(average_growth_per_country_in_nineties))
 

 multifactor_productivity_annual_growth %>% 
   group_by(country) %>% 
     filter(time < 2010,
            time > 2000) %>% 
   summarise(average_growth_per_country_in_noughties = mean(value_usd)) %>% 
   arrange(desc(average_growth_per_country_in_noughties))
 
  
   multifactor_productivity_annual_growth %>% 
   group_by(country) %>% 
     filter(time < 2017,
            time > 2010) %>% 
   summarise(average_growth_per_country_in_tens = mean(value_usd)) %>% 
   arrange(desc(average_growth_per_country_in_tens))
  
   
   multifactor_productivity_annual_growth %>% 
     filter(country == "United Kingdom") 
   
international_labour_productivity_gdpphr

all <-
investment_and_per_hour_gdp %>% 
  dplyr::select(-investment_as_percentage_of_gdp) %>% 
  group_by(year) %>% 
  summarise(average_multifactor_gdp = mean(multifactor_gdp)) %>% 
  mutate(country = as.character("All"))



uk <-
investment_and_per_hour_gdp %>% 
  dplyr::select(-investment_as_percentage_of_gdp) %>% 
  group_by(year) %>% 
  filter(country == "United Kingdom") %>% 
  summarise(average_multifactor_gdp = mean(multifactor_gdp)) %>% 
  mutate(country = as.character("United Kingdom"))
   

rbind(all, uk, by = c("average_multifactor_gdp")) %>% 
  filter(country != "average_multifactor_gdp") %>% 
  mutate(average_multifactor_gdp = as.numeric(average_multifactor_gdp)) %>% 
  ggplot() +
  aes(x = year, y = average_multifactor_gdp) +
  geom_point(aes(colour = country)) +
  theme(axis.text.x = element_text(angle = 45, vjust = 0.5)) +
  geom_smooth(method = "lm") +
  labs(x = "Year", y = "GDP per Hour")


investment_and_gdp_annual_growth

investment_and_per_hour_gdp

investment_gdp_and_adult_education_levels_tertiary_minimum_wage_tech

(str_extract(average_multifactor_gdp, "^[0-9]+"))

all
```

```{r}
all_p <-
investment_and_gdp_annual_growth %>% 
  dplyr::select(-investment_as_percentage_of_gdp, -investment_rolling_5_year_avg, -investment_increase_from_previous_year) %>% 
  group_by(year) %>% 
  summarise(average_multifactor_gdp_growth = mean(multifactor_gdp_growth)) %>% 
  mutate(country = as.character("All"))

all_p



uk_p <-
investment_and_gdp_annual_growth %>% 
  dplyr::select(-investment_as_percentage_of_gdp, -investment_rolling_5_year_avg, -investment_increase_from_previous_year) %>% 
  group_by(year) %>% 
  filter(country == "United Kingdom") %>% 
  summarise(average_multifactor_gdp_growth = mean(multifactor_gdp_growth)) %>% 
  mutate(country = as.character("United Kingdom"))

uk_p

   
comparison <-
rbind(all_p, uk_p, by = c("average_multifactor_gdp_growth")) %>% 
  filter(country != "average_multifactor_gdp_growth") %>% 
  mutate(average_multifactor_gdp_growth = as.numeric(average_multifactor_gdp_growth)) 
  
comparison %>% 
  ggplot(aes(x = year, y = average_multifactor_gdp_growth, fill = country)) +
  geom_col(position = "dodge") +
  theme(axis.text.x = element_text(angle = 45, vjust = 0.5)) +
  labs(x = "Year", y = "Multifactor Productivity Growth") #+
  scale_y_discrete(limits = c(-4, 4), breaks = 6)

```




```{r}
investment_gdp_and_adult_education_levels_tertiary_minimum_wage_tech_uk <-
  investment_gdp_and_adult_education_levels_tertiary_minimum_wage_tech %>% 
  filter(country == "United Kingdom") %>% 
  mutate(research_and_development_expenditure_percent_of_gdp = as.numeric(research_and_development_expenditure_percent_of_gdp)) 
  dplyr::select(high_technology_exports_percent_of_manufactured_exports, research_and_development_expenditure_percent_of_gdp, multifactor_gdp, percentage_of_25_64_year_olds)

investment_as_percentage_of_gdp
annual_pay_in_usd
investment_gdp_and_adult_education_levels_tertiary_minimum_wage_tech

ggpairs(investment_gdp_and_adult_education_levels_tertiary_minimum_wage_tech_uk)
```


```{r}
all_p <-
investment_and_gdp_annual_growth %>% 
  dplyr::select(-investment_as_percentage_of_gdp, -investment_rolling_5_year_avg, -investment_increase_from_previous_year) %>% 
  group_by(year) %>% 
  summarise(average_multifactor_gdp_growth = mean(multifactor_gdp_growth)) %>% 
  mutate(country = as.character("All"))

all_p



uk_p <-
investment_and_gdp_annual_growth %>% 
  dplyr::select(-investment_as_percentage_of_gdp, -investment_rolling_5_year_avg, -investment_increase_from_previous_year) %>% 
  group_by(year) %>% 
  filter(country == "United Kingdom") %>% 
  summarise(average_multifactor_gdp_growth = mean(multifactor_gdp_growth)) %>% 
  mutate(country = as.character("United Kingdom"))

uk_p

   
comparison <-
rbind(all_p, uk_p, by = c("average_multifactor_gdp_growth")) %>% 
  filter(country != "average_multifactor_gdp_growth") %>% 
  mutate(average_multifactor_gdp_growth = as.numeric(average_multifactor_gdp_growth)) 
  
comparison %>% 
  ggplot(aes(x = year, y = average_multifactor_gdp_growth, fill = country)) +
  geom_col(position = "dodge") +
  theme(axis.text.x = element_text(angle = 45, vjust = 0.5)) +
  labs(x = "Year", y = "Multifactor Productivity Growth") #+
  scale_y_discrete(limits = c(-4, 4), breaks = 6)

  library(reshape)
  
   
melt(investment_and_gdp_annual_growth, id.vars = "year", variable.name = "series")
  
  investment_and_gdp_annual_growth %>% 
    dplyr::select(country, investment_as_percentage_of_gdp, multifactor_gdp_growth, year) %>% 
    filter(country == "United Kingdom") %>% 
    ggplot(aes(year, investment_as_percentage_of_gdp)) +
    geom_line(size = 2, colour = "#800020") +
    scale_x_continuous(limits = c(1995, 2016), breaks = seq(1995, 2016, 1)) +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.5)) +
    labs(x = "Year", y = "Infrastructure Investment as Percentage of GDP")


    
    
    
```




```{r}
investment_and_gdp_annual_growth
```

```{r}
  investment_and_gdp_annual_growth %>% 
    dplyr::select(country, investment_as_percentage_of_gdp, multifactor_gdp_growth, year) %>% 
    filter(country == "United Kingdom") %>% 
    ggplot(aes(year, investment_as_percentage_of_gdp)) +
    geom_line(size = 2, colour = "#800020") +
    scale_x_continuous(limits = c(1995, 2016), breaks = seq(1995, 2016, 1)) +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.5)) +
    labs(x = "Year", y = "Infrastructure Investment as Percentage of GDP")

investment_gdp_and_adult_education_levels_tertiary_minimum_wage_tech %>% 
  dplyr::select(percentage_of_25_64_year_olds, year, country) %>% 
  filter(country == "United Kingdom") %>% 
  ggplot(aes(year, percentage_of_25_64_year_olds)) +
    geom_line(size = 2, colour = "#800020") +
    scale_x_continuous(limits = c(1995, 2016), breaks = seq(1995, 2016, 1)) +
    theme(axis.text.x = element_text(angle = 45, vjust = 0.5)) +
    labs(x = "Year", y = "% of 25-64 Years Olds Who Are University-Educated")
```










